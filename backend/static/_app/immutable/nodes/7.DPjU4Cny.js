import"../chunks/DsnmJJEf.js";import"../chunks/Czs3uoK7.js";import{o as He,s as P,e as d}from"../chunks/DjEdHHdZ.js";import{p as Ke,an as B,ao as Xe,f as h,h as Ye,e as oe,a as c,b as Ze,t as E,ad as u,g as e,m,$ as et,d as l,c as a,s as v,r,i as _e,n as tt,Q as he,ag as J,j as ie}from"../chunks/CSL_G-ra.js";import{i as $}from"../chunks/CZ6qWho8.js";import{e as rt,i as at}from"../chunks/D0dqcScj.js";import{r as st}from"../chunks/BOe3PIrR.js";import{s as we,a as ot,b as it}from"../chunks/DFvihwEc.js";import{a as ke,b as lt}from"../chunks/C6oE0YpH.js";import{i as nt}from"../chunks/D8J5l3fY.js";import{s as dt,a as ct}from"../chunks/B0RP_nXW.js";import{g as Se}from"../chunks/CI6f0tGy.js";import{u as Re,p as vt}from"../chunks/cu_vdabb.js";const ut=!0,pt=ut;var mt=h('<div class="flex items-center gap-2"><span class="text-sm text-amber-400">Admin</span> <a href="/admin/posts" class="text-sm transition-colors hover:text-blue-300" style="color: #00d4ff;">Manage</a></div>'),ft=h('<div class="text-center"><div class="animate-pulse text-gray-300">Loading posts...</div></div>'),gt=h('<button class="px-4 py-2 text-white rounded transition-all duration-200 cursor-pointer hover:scale-105" style="background: linear-gradient(135deg, var(--replicant-primary), var(--replicant-secondary)); border: 1px solid var(--replicant-border);">+ Add New Post</button>'),bt=h('<div class="text-xs text-gray-400"> </div>'),xt=h('<div class="border border-gray-700 rounded-lg p-6 cursor-pointer transition-all duration-200 hover:border-blue-400 hover:scale-[1.02]" style="background: rgba(17, 17, 20, 0.85); backdrop-filter: blur(10px);" role="button" tabindex="0"><div class="flex justify-between items-start"><div class="flex-1"><h3 class="font-medium text-white mb-2 text-lg"> </h3> <div class="text-sm text-gray-400"><span style="color: #00d4ff;"> </span> </div></div> <div class="ml-4 flex flex-col items-end"><button class="px-3 py-1 text-white rounded text-sm transition-all duration-200 hover:scale-105 cursor-pointer mb-2" style="background: linear-gradient(135deg, var(--replicant-primary), var(--replicant-secondary)); border: 1px solid var(--replicant-border);"><!></button> <!></div></div></div>'),yt=h('<div class="max-w-4xl mx-auto"><div class="flex justify-between items-center mb-6"><h2 class="text-xl font-semibold text-white"> </h2> <!></div> <div class="grid gap-4"></div></div>'),_t=h('<div class="text-center text-gray-400 max-w-2xl mx-auto"><h2 class="text-xl font-semibold mb-4 text-white"> </h2> <p class="mb-6">There are currently no posts available for this subreddit. Check back later or try a different community.</p> <a href="/subreddit" class="px-6 py-3 text-white rounded transition-all duration-200 cursor-pointer hover:scale-105 inline-block" style="background: linear-gradient(135deg, var(--replicant-primary), var(--replicant-secondary)); border: 1px solid var(--replicant-border);">← Choose Different Community</a></div>'),ht=h('<div class="mt-3 text-amber-400 text-sm"> </div>'),wt=h(`<div style="background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(2px);"><div style="background: rgba(17, 17, 20, 0.95); backdrop-filter: blur(10px);"><div class="flex justify-between items-center mb-4"><h2 class="text-lg font-semibold text-white">Submit New Reddit Post</h2> <button class="text-gray-400 hover:text-white transition-colors">✕</button></div> <div class="flex gap-3"><input placeholder="https://www.reddit.com/r/subreddit/comments/xyz/title/" class="flex-1 px-3 py-2 rounded bg-gray-800 border border-gray-600 text-white placeholder-gray-400 focus:border-blue-400 focus:outline-none"/> <button class="px-4 py-2 text-white rounded transition-all duration-200 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105" style="background: linear-gradient(135deg, var(--replicant-primary), var(--replicant-secondary)); border: 1px solid var(--replicant-border);"> </button></div> <!> <div class="mt-3 text-gray-400 text-sm">Paste any Reddit post URL. We'll fetch the comments, generate AI comments, and create a guessing game.</div></div></div>`),kt=h('<div class="min-h-screen text-gray-100" style="background: linear-gradient(180deg, #0a0a0b 0%, #111013 100%)"><div class="fixed top-0 left-0 right-0 z-50 border-b border-gray-700" style="background: rgba(17, 17, 20, 0.95); backdrop-filter: blur(10px);"><div class="max-w-4xl mx-auto px-4 md:px-0 py-3"><div class="flex items-center justify-between"><div class="flex items-center gap-4"><a href="/subreddit" class="transition-colors flex items-center gap-1" style="color: #00d4ff;">← Back</a> <a href="/" class="text-lg font-bold cursor-pointer hover:text-blue-300 transition-colors" style="color: #f3f4f6; text-shadow: 0 0 8px rgba(0, 212, 255, 0.1);">Reddit or <span class="glitch" data-text="Replicant">Replicant</span>?</a></div> <div class="flex items-center gap-4"><a href="/about" class="transition-colors text-sm" style="color: #00d4ff;">About</a> <!></div></div></div></div> <div class="pt-16"><div class="container mx-auto p-8 md:px-0"><!></div></div></div> <!>',1);function It(Pe,le){Ke(le,!1);const ne=()=>ct(vt,"$page",$e),[$e,je]=dt(),O=m();let N=m([]),Q=m(!0),U=m(!1),C=m(""),T=m(""),V=m(!1),j=m(!1),W=m({}),A=m(""),I=m(!1),p=m("");function Ae(){l(V,!0),setTimeout(()=>l(j,!0),10)}function H(){l(j,!1),setTimeout(()=>l(V,!1),300)}He(async()=>{await new Promise(t=>setTimeout(t,0)),await K()});async function K(){if(!e(p)){console.log("No currentSubreddit, skipping load");return}console.log("Loading posts for subreddit:",e(p));try{l(Q,!0);const t=await fetch(`/api/posts/subreddit/${e(p)}`);if(!t.ok)throw new Error("Failed to fetch posts");const s=await t.json();console.log("Received data:",s),l(N,s.posts||[]),console.log("Set posts to:",e(N))}catch(t){l(C,"Failed to load posts"),console.error("Error loading posts:",t)}finally{l(Q,!1)}}async function Ee(){if(!(!e(A)||e(I)))try{const t=await fetch(`/api/users/${e(A)}/progress`);if(!t.ok){console.error("Failed to load user progress");return}const s=await t.json();l(W,s.progress||{}),l(I,!0)}catch(t){console.error("Error loading user progress:",t)}}function Te(t,s){const x=e(W)[t];return!x||x.total_guesses===0?"not-started":x.total_guesses>=s?"completed":"in-progress"}async function de(){if(e(T).trim())try{l(U,!0),l(C,"");const t=await fetch("/api/posts/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e(T).trim()})});if(!t.ok){const x=await t.json();throw new Error(x.detail||"Failed to submit URL")}const s=await t.json();console.log("Submitted successfully:",s),l(T,""),H(),await K(),pt&&e(A)&&l(I,!1),s.id&&Se(`/test?post=${s.id}`)}catch(t){l(C,t.message),console.error(t)}finally{l(U,!1)}}function ce(t){Se(`/test?post=${t}`)}function X(t){return{unpopularopinion:"r/unpopularopinion",AmItheAsshole:"r/AmItheAsshole",relationship_advice:"r/relationship_advice"}[t]||`r/${t}`}B(()=>ne(),()=>{l(p,ne().params.subreddit||"")}),B(()=>e(p),()=>{e(p)&&K()}),B(()=>ke,()=>{l(O,ke.isAdmin())}),B(()=>(e(A),Re),()=>{e(A)||l(A,Re.getUserId())}),B(()=>(e(A),e(I)),()=>{e(A)&&!e(I)&&Ee()}),Xe(),nt();var ve=kt();Ye(t=>{E(s=>et.title=`${s??""} - Reddit or Replicant`,[()=>(e(p),u(()=>X(e(p))))])});var Y=oe(ve),Z=a(Y),ue=a(Z),pe=a(ue),me=v(a(pe),2),Ue=v(a(me),2);{var De=t=>{var s=mt();c(t,s)};$(Ue,t=>{e(O)&&t(De)})}r(me),r(pe),r(ue),r(Z);var fe=v(Z,2),ge=a(fe),Me=a(ge);{var Ne=t=>{var s=ft();c(t,s)},Ce=t=>{var s=_e(),x=oe(s);{var D=y=>{var w=yt(),f=a(w),g=a(f),b=a(g);r(g);var k=v(g,2);{var ee=i=>{var o=gt();d("click",o,Ae),d("mouseenter",o,_=>_.target.style.boxShadow="0 0 15px var(--replicant-glow)"),d("mouseleave",o,_=>_.target.style.boxShadow=""),c(i,o)};$(k,i=>{e(O)&&i(ee)})}r(f);var G=v(f,2);rt(G,5,()=>e(N),at,(i,o)=>{const _=he(()=>(e(o),u(()=>Te(e(o).id,e(o).total_count)))),S=he(()=>(e(W),e(o),u(()=>e(W)[e(o).id])));var L=xt(),be=a(L),te=a(be),re=a(te),Fe=a(re,!0);r(re);var xe=v(re,2),ae=a(xe),ze=a(ae);r(ae);var Be=v(ae);r(xe),r(te);var ye=v(te,2),F=a(ye),Oe=a(F);{var We=n=>{var R=ie();E(z=>P(R,`Review (${z??""}% accuracy)`),[()=>(J(e(S)),u(()=>Math.round(e(S).accuracy*100)))]),c(n,R)},qe=n=>{var R=_e(),z=oe(R);{var Qe=M=>{var se=ie("Continue");c(M,se)},Ve=M=>{var se=ie("Begin Test");c(M,se)};$(z,M=>{e(_)==="in-progress"?M(Qe):M(Ve,!1)},!0)}c(n,R)};$(Oe,n=>{e(_)==="completed"?n(We):n(qe,!1)})}r(F);var Ge=v(F,2);{var Je=n=>{var R=bt(),z=a(R);r(R),E(()=>P(z,`${J(e(S)),u(()=>e(S).total_guesses)??""} guessed (${J(e(S)),u(()=>e(S).correct_guesses)??""} correct)`)),c(n,R)};$(Ge,n=>{J(e(S)),u(()=>e(S)&&e(S).total_guesses>0)&&n(Je)})}r(ye),r(be),r(L),E(()=>{P(Fe,(e(o),u(()=>e(o).title))),P(ze,`r/${e(o),u(()=>e(o).subreddit)??""}`),P(Be,` • ${e(o),u(()=>e(o).total_count)??""} comments`)}),d("mouseenter",F,n=>n.target.style.boxShadow="0 0 15px var(--replicant-glow)"),d("mouseleave",F,n=>n.target.style.boxShadow=""),d("click",L,()=>ce(e(o).id)),d("keydown",L,n=>n.key==="Enter"&&ce(e(o).id)),c(i,L)}),r(G),r(w),E(i=>P(b,`Replicants hiding in ${i??""}`),[()=>(e(p),u(()=>X(e(p))))]),c(y,w)},q=y=>{var w=_t(),f=a(w),g=a(f);r(f);var b=v(f,4);r(w),E(k=>P(g,`No posts found in ${k??""}`),[()=>(e(p),u(()=>X(e(p))))]),d("mouseenter",b,k=>k.target.style.boxShadow="0 0 15px var(--replicant-glow)"),d("mouseleave",b,k=>k.target.style.boxShadow=""),c(y,w)};$(x,y=>{e(N),u(()=>e(N).length>0)?y(D):y(q,!1)},!0)}c(t,s)};$(Me,t=>{e(Q)?t(Ne):t(Ce,!1)})}r(ge),r(fe),r(Y);var Ie=v(Y,2);{var Le=t=>{var s=wt();let x;var D=a(s);let q;var y=a(D),w=v(a(y),2);r(y);var f=v(y,2),g=a(f);st(g);var b=v(g,2),k=a(b,!0);r(b),r(f);var ee=v(f,2);{var G=i=>{var o=ht(),_=a(o,!0);r(o),E(()=>P(_,e(C))),c(i,o)};$(ee,i=>{e(C)&&i(G)})}tt(2),r(D),r(s),E((i,o,_)=>{x=we(s,1,"fixed inset-0 flex items-center justify-center z-50 transition-opacity duration-300",null,x,i),q=we(D,1,"border border-gray-700 rounded-lg p-6 m-4 max-w-2xl w-full transform transition-all duration-300",null,q,o),g.disabled=e(U),b.disabled=_,P(k,e(U)?"Processing...":"Submit & Play")},[()=>({"opacity-0":!e(j),"opacity-100":e(j)}),()=>({"scale-95":!e(j),"opacity-0":!e(j),"scale-100":e(j),"opacity-100":e(j)}),()=>(e(U),e(T),u(()=>e(U)||!e(T).trim()))]),d("click",w,H),lt(g,()=>e(T),i=>l(T,i)),d("keydown",g,i=>i.key==="Enter"&&de()),d("click",b,de),d("mouseenter",b,i=>i.target.style.boxShadow="0 0 15px var(--replicant-glow)"),d("mouseleave",b,i=>i.target.style.boxShadow=""),d("click",D,ot(function(i){it.call(this,le,i)})),d("click",s,H),c(t,s)};$(Ie,t=>{e(V)&&e(O)&&t(Le)})}c(Pe,ve),Ze(),je()}export{It as component};
